# coding=utf-8
"""
Africa Rangeland Watch (ARW).

.. note:: Analysis APIs
"""
import json
import logging
from datetime import date
from rest_framework import status
from rest_framework.permissions import IsAuthenticated
from rest_framework.response import Response
from rest_framework.views import APIView
from rest_framework import serializers

from core.models import TaskStatus
from analysis.analysis import (
    AnalysisResultsCacheUtils,
    spatial_get_date_filter,
    validate_spatial_date_range_filter
)
from analysis.models import AnalysisTask, LandscapeCommunity
from analysis.runner import AnalysisRunner
from analysis.tasks import run_analysis_task


class AnalysisResultSerializer(serializers.Serializer):
    """Serializer for analysis API response."""
    data = serializers.JSONField()
    results = serializers.JSONField(allow_null=True)
    task_id = serializers.IntegerField(allow_null=True)
    status = serializers.ChoiceField(choices=TaskStatus.choices)
    is_cached = serializers.BooleanField()
    error = serializers.CharField(allow_null=True, required=False)
    started_at = serializers.DateTimeField(allow_null=True, required=False)
    completed_at = serializers.DateTimeField(allow_null=True, required=False)


class AnalysisAPI(APIView):
    """API to do analysis."""

    permission_classes = [IsAuthenticated]

    def check_cache(self, data):
        """Check if results are already cached."""
        analysis_dict = {}
        locations = data.get('locations', [])
        args = []
        kwargs = {}
        if data['analysisType'] == 'Temporal':
            analysis_dict = AnalysisRunner.get_analysis_dict_temporal(data)
            analysis_cache = AnalysisResultsCacheUtils({
                'locations': locations,
                'analysis_dict': analysis_dict,
                'args': args,
                'kwargs': kwargs
            })
            return analysis_cache.get_analysis_cache()

        elif data['analysisType'] == 'Spatial':
            analysis_dict = AnalysisRunner.get_analysis_dict_spatial(data)
            reference_layer_geom = (
                AnalysisRunner.get_reference_layer_geom(data)
            )
            kwargs = {
                'reference_layer': reference_layer_geom,
                'custom_geom': data.get('custom_geom', None)
            }
        elif data['analysisType'] == 'Baseline':
            analysis_dict = AnalysisRunner.get_analysis_dict_baseline(data)
            kwargs['custom_geom'] = data.get('custom_geom', None)

        analysis_cache = AnalysisResultsCacheUtils({
            'locations': locations,
            'analysis_dict': analysis_dict,
            'args': args,
            'kwargs': kwargs
        })

        return analysis_cache.get_analysis_cache()

    def validate_spatial_analysis(self, data):
        """Validate spatial analysis inputs."""
        reference_layer_geom = AnalysisRunner.get_reference_layer_geom(data)
        if reference_layer_geom is None:
            raise ValueError(
                'Invalid reference_layer with id '
                f'{data.get('reference_layer_id')}!'
            )

        (
            spatial_analysis_dict, 
            temporal_analysis_dict
        ) = AnalysisRunner.get_analysis_dict_spatial(data)
        filter_start_date, filter_end_date = spatial_get_date_filter(
            spatial_analysis_dict
        )

        valid_filters, start_meta, end_meta = (
            validate_spatial_date_range_filter(
                data['variable'], filter_start_date, filter_end_date
            )
        )
        if not valid_filters:
            # validate the filter is within asset date ranges
            raise ValueError(
                f'{data['variable']} year range filter must be between '
                f'{date.fromisoformat(start_meta).year} to '
                f'{date.fromisoformat(end_meta).year}'
            )

    def post(self, request, *args, **kwargs):
        """Fetch list of Landscape."""
        data = request.data
        try:
            if (
                data['analysisType'] not in
                ['Baseline', 'Temporal', 'Spatial']
            ):
                raise ValueError('Invalid analysis type')
            
            if data['analysisType'] == 'Spatial':
                self.validate_spatial_analysis(data)
                intersects_communities = LandscapeCommunity.objects.filter(
                    geometry__intersects=json.dumps(data['reference_layer']['features'][0]['geometry'])
                ).order_by('community_id')
                data['locations'] = [{
                    "lat": community.geometry.centroid.y,
                    "lon": community.geometry.centroid.x,
                    "community": community.community_id,
                    "communityName": community.community_name,
                    "communityFeatureId": community.id
                } for community in intersects_communities]

            # check if analysis is already cached
            results = self.check_cache(data)
            results = {"spatial": {"results": {"type": "FeatureCollection", "columns": {"mean": "Float<-752.1575369828694, 552.1376076873092>"}, "features": [{"id": "0000000000000000015c", "type": "Feature", "geometry": {"type": "Polygon", "coordinates": [[[31.55780556371505, -23.17140601327735], [31.562960984482164, -23.186707012105224], [31.552817408182563, -23.284283319553623], [31.548418829131982, -23.416060599671013], [31.558697100952642, -23.4730175002614], [31.559549872976373, -23.47526169659594], [31.55990897423248, -23.47867281826042], [31.56381381175505, -23.485135973544313], [31.565474507363604, -23.486437633631976], [31.662197977321593, -23.585988743378326], [31.69002560589933, -23.62553096830958], [31.697431338966155, -23.722344158303127], [31.76780837709558, -23.88491143801982], [31.880510277863113, -23.95273007407832], [31.880824496345713, -23.955378235987904], [31.89173109339961, -23.94788271155023], [31.89361619950683, -23.946985042638154], [31.904074011379517, -23.943708590236504], [31.918257170876377, -23.94204789968336], [31.92247615102687, -23.942092744155993], [31.931138635458193, -23.943125072103285], [31.93553724349518, -23.94308022780411], [31.93805066723644, -23.942272273098556], [31.942090166996504, -23.9385470117411], [31.94756591429791, -23.935943788700172], [31.947431293658365, -23.92858286521056], [31.952099174527184, -23.92158111309848], [31.9546125666671, -23.91875344701566], [31.96004351556607, -23.916105320163716], [31.964397141281122, -23.9128288361778], [31.969424085680807, -23.907712135028028], [31.97364309761214, -23.90237109188593], [31.98360723142001, -23.89379835854515], [31.98531280602106, -23.88989346371354], [31.987646702580115, -23.886033505030642], [31.99312243117562, -23.88037824993656], [31.995770571906203, -23.87853799032253], [31.99886752162968, -23.87773011684065], [32.00295188736861, -23.877415929503634], [32.008068580605446, -23.877730165651673], [32.01372388644579, -23.878852203161987], [32.026964486839745, -23.882263306841807], [32.03755693696046, -23.882263370845553], [32.05129125199838, -23.87885220494841], [32.05941506398239, -23.873376484001607], [32.06484600551704, -23.869157420148312], [32.07844562132166, -23.856679858580243], [32.081407932444236, -23.85466014799093], [32.08544741965128, -23.853403374801793], [32.08809548285336, -23.85187734283502], [32.090923173289376, -23.851248974095984], [32.09446892917615, -23.85124899473319], [32.098239147112345, -23.85232619448872], [32.10788906560409, -23.85717357097145], [32.11381364295997, -23.861527275012218], [32.11879564912039, -23.867003042980656], [32.122386333037284, -23.869292083939634], [32.13270952335475, -23.872927635236714], [32.14509729578511, -23.8741843801029], [32.15595905717297, -23.85053084500405], [32.1847292175923, -23.799408823983537], [32.19379568411803, -23.76731725383481], [32.19603979559958, -23.74963325717109], [32.25829292351271, -23.729570409768137], [32.3186609321318, -23.66691331904977], [32.33553707513439, -23.56987564094127], [32.29276330195272, -23.51220062474656], [32.27557299095684, -23.470952863703836], [32.25811342464172, -23.43096188326382], [32.25317622176945, -23.4206387472711], [32.26318523320546, -23.41184160738729], [32.2674940427067, -23.403448383969888], [32.2718028510017, -23.39227250150902], [32.27247610007106, -23.38051306978939], [32.267090074879135, -23.37207501192267], [32.253131388202604, -23.36246993132022], [32.2471170281179, -23.357398160755633], [32.23863409850018, -23.34837657200117], [32.23867893815641, -23.34106066453711], [32.23019603093887, -23.341015789537554], [32.22718881014888, -23.33374469882544], [32.22543838985328, -23.319696181351325], [32.218212181308914, -23.309552536439252], [32.21524990602356, -23.299453851337717], [32.21466634180736, -23.294022936930137], [32.2079339107011, -23.28805346777343], [32.200752588606264, -23.279121694198295], [32.196892604537766, -23.272927841072196], [32.19424452748999, -23.266599221494793], [32.1913719147805, -23.254839821884858], [32.19069867429294, -23.248241981067284], [32.19101286525965, -23.23899608474865], [32.192090096818575, -23.233116294338767], [32.19334683886812, -23.22867291526936], [32.190070376202094, -23.225890153391433], [32.18437014585077, -23.219920621983682], [32.18145275170223, -23.215970881587506], [32.17871482408204, -23.211168392942863], [32.17391236931717, -23.199723194485358], [32.17153353864524, -23.192317437677413], [32.170501228939756, -23.187784228743187], [32.16960360169593, -23.181051679051624], [32.169558646511, -23.17566573543842], [32.170276801176755, -23.17001045780243], [32.17355326141922, -23.159328236117588], [32.17700934364023, -23.152730329269648], [32.18019604362095, -23.14815224072189], [32.18423547198636, -23.14352928395584], [32.18966637555552, -23.134148699843955], [32.18670409070529, -23.129929677323688], [32.1847740798239, -23.126294136956204], [32.1761115975165, -23.119830940228034], [32.173149371869904, -23.11700325828983], [32.16951377792618, -23.11264955991439], [32.162781285846776, -23.108924283827385], [32.15492668465541, -23.103044553679453], [32.145501203974334, -23.098646004510744], [32.138903414151045, -23.094561627854567], [32.130734612488624, -23.08814329952159], [32.12409189858311, -23.081410837575092], [32.11385853473095, -23.076114622235714], [32.105061384880955, -23.076742957155496], [32.09711703191828, -23.07660828278203], [32.09146172722023, -23.07584528814997], [32.07786209604932, -23.073017636440884], [32.068346836365436, -23.070279807522283], [32.06085135882934, -23.067452101846172], [32.0524133208847, -23.06287403912547], [32.04608475293963, -23.058161263307067], [32.04078850766437, -23.053089438152625], [32.037377416896916, -23.049094866682438], [32.03284422041503, -23.04204818666495], [32.030196024828555, -23.03652753272581], [32.02858022444383, -23.03172501136204], [32.02750309761287, -23.02629414223752], [32.02669518045527, -23.018933262195716], [32.02647071459334, -23.009373181937093], [32.00551026394283, -23.002146914278615], [31.99877772980175, -22.999050015498575], [31.994064986797003, -22.996087673503634], [31.984011133183746, -22.98877175645138], [31.97759286679199, -22.982892024626302], [31.972790352932538, -22.976563414389194], [31.96893040060239, -22.96879866631991], [31.964397141281122, -22.961976391622958], [31.962153005311958, -22.957218744401693], [31.960716713371593, -22.952999699211034], [31.95945996419753, -22.94685070192903], [31.95896632105728, -22.940073334740504], [31.95928048941681, -22.93343059430913], [31.96062697704567, -22.926967382093416], [31.955689803904022, -22.9243642286721], [31.949899833270912, -22.920414428526165], [31.94226966986984, -22.91682381914566], [31.93531276431391, -22.911886677027752], [31.929792133702836, -22.9069046317294], [31.92620152650891, -22.902865091491083], [31.922969871227203, -22.898197270342038], [31.92027890868585, -22.892994857182725], [31.90643464061185, -22.895892618187336], [31.88720854858628, -22.941428388718847], [31.873475649442188, -22.94901616089469], [31.847383103710953, -22.99832653109984], [31.81305088459269, -23.017287197802652], [31.784211722398734, -23.00591115982221], [31.752045094172782, -23.01728725382652], [31.64630170251097, -23.075416829264842], [31.603729650259154, -23.124680918411947], [31.55780556371505, -23.17140601327735]]]}, "properties": {"Name": "Limpopo National Park Central", "area": 603628.8301880993, "mean": -5.052799911047894, "Project": "Limpopo NP Project"}}, {"id": "00000000000000000171", "type": "Feature", "geometry": {"type": "Polygon", "coordinates": [[[31.901055489499495, -23.82625223428463], [31.903186949799316, -23.834786955558442], [31.90501967577204, -23.83783700640368], [31.911422906775478, -23.82899460809065], [31.921790304276552, -23.823505406199107], [31.93123916016849, -23.818020767821686], [31.944045673554893, -23.81344567464486], [31.953195790935286, -23.809784753076034], [31.965694621277223, -23.80551740083539], [31.97575883376423, -23.805214162879377], [31.985822989525968, -23.807956526510218], [31.99496866651786, -23.80643152882146], [32.00289688651595, -23.80277509086546], [32.00991109361633, -23.801553239816993], [32.017839356858346, -23.802164134209995], [32.02850997170983, -23.80277507978359], [32.03856970209388, -23.803381491607556], [32.044058919476534, -23.802775069268122], [32.04649796248863, -23.777768398570434], [32.05015893921867, -23.764658647516615], [32.05412310961948, -23.751852101016052], [32.055037217306136, -23.741181531727694], [32.058087222206815, -23.733253244210143], [32.0568654096223, -23.725324931422506], [32.05381537044208, -23.717396645227637], [32.04558386975399, -23.70977159503888], [32.036741462522805, -23.704893381310768], [32.0245458227942, -23.701847770381857], [32.01570344318162, -23.698490067017424], [32.00991109361633, -23.694833620216244], [32.0056392612362, -23.69025853512694], [31.998321915848884, -23.685077047963635], [31.9910045144634, -23.68355206293806], [31.980940314405295, -23.685683491699415], [31.976369718727913, -23.68873356305867], [31.97209787806578, -23.69056180127857], [31.964174109597405, -23.690561809759625], [31.958988104583046, -23.692394449306878], [31.95563486610222, -23.69391946039026], [31.951367512218212, -23.696358597883393], [31.939778303504173, -23.6957476953752], [31.93154681035205, -23.695136863835177], [31.92514353338086, -23.694525913037374], [31.922396801380817, -23.684769379037675], [31.919351172911934, -23.681416156075045], [31.916907646536878, -23.683244387860242], [31.915387067723326, -23.686905289406518], [31.912029374117687, -23.703065061588422], [31.91020110588854, -23.71099342822669], [31.909590200368317, -23.720139023463684], [31.91020110588854, -23.731117306540717], [31.910812008024322, -23.743009725944038], [31.911115200380166, -23.760083621226386], [31.911115200380166, -23.770451033817423], [31.909287003819372, -23.784479371184087], [31.906544652152146, -23.79697822744883], [31.90196965977683, -23.80856743343943], [31.901055489499495, -23.816798962209504], [31.901055489499495, -23.82625223428463]]]}, "properties": {"Name": "Mavodze_A", "area": 18577.221932295255, "mean": 0.10124720595606695, "Project": "Limpopo NP Project"}}, {"id": "00000000000000000172", "type": "Feature", "geometry": {"type": "Polygon", "coordinates": [[[31.901055489499495, -23.82625223428463], [31.903186949799316, -23.834786955558442], [31.90501967577204, -23.83783700640368], [31.911422906775478, -23.82899460809065], [31.921790304276552, -23.823505406199107], [31.93123916016849, -23.818020767821686], [31.944045673554893, -23.81344567464486], [31.953195790935286, -23.809784753076034], [31.965694621277223, -23.80551740083539], [31.97575883376423, -23.805214162879377], [31.985822989525968, -23.807956526510218], [31.99496866651786, -23.80643152882146], [32.00289688651595, -23.80277509086546], [32.00991109361633, -23.801553239816993], [32.017839356858346, -23.802164134209995], [32.02850997170983, -23.80277507978359], [32.03856970209388, -23.803381491607556], [32.044058919476534, -23.802775069268122], [32.04649796248863, -23.777768398570434], [32.05015893921867, -23.764658647516615], [32.05412310961948, -23.751852101016052], [32.055037217306136, -23.741181531727694], [32.058087222206815, -23.733253244210143], [32.0568654096223, -23.725324931422506], [32.05381537044208, -23.717396645227637], [32.04558386975399, -23.70977159503888], [32.036741462522805, -23.704893381310768], [32.0245458227942, -23.701847770381857], [32.01570344318162, -23.698490067017424], [32.00991109361633, -23.694833620216244], [32.0056392612362, -23.69025853512694], [31.998321915848884, -23.685077047963635], [31.9910045144634, -23.68355206293806], [31.980940314405295, -23.685683491699415], [31.976369718727913, -23.68873356305867], [31.97209787806578, -23.69056180127857], [31.964174109597405, -23.690561809759625], [31.958988104583046, -23.692394449306878], [31.95563486610222, -23.69391946039026], [31.951367512218212, -23.696358597883393], [31.939778303504173, -23.6957476953752], [31.93154681035205, -23.695136863835177], [31.92514353338086, -23.694525913037374], [31.922396801380817, -23.684769379037675], [31.919351172911934, -23.681416156075045], [31.916912074365065, -23.683244424822195], [31.915387067723326, -23.686905289406518], [31.912029374117687, -23.703065061588422], [31.91020110588854, -23.71099342822669], [31.909590200368317, -23.720139023463684], [31.91020110588854, -23.731117306540717], [31.910812008024322, -23.743009725944038], [31.911115200380166, -23.760083621226386], [31.911115200380166, -23.770451033817423], [31.909287003819372, -23.784479371184087], [31.906544652152146, -23.79697822744883], [31.90196965977683, -23.80856743343943], [31.901055489499495, -23.816798962209504], [31.901055489499495, -23.82625223428463]]]}, "properties": {"Name": "Mavodze 1", "area": 18577.20808911069, "mean": 0.10124647619140546, "Project": "Limpopo NP Project"}}, {"id": "00000000000000000178", "type": "Feature", "geometry": {"type": "Polygon", "coordinates": [[[32.055340444083285, -23.800331459874393], [32.056562187098656, -23.805517399974644], [32.0568654096223, -23.80887065772401], [32.05869807999482, -23.811920655868335], [32.06479372369196, -23.812834779076972], [32.069061068987544, -23.81161745845849], [32.07241880101874, -23.81039568544611], [32.07698935970331, -23.81100655242554], [32.07790344833732, -23.813748880166205], [32.08278620179642, -23.81618802731346], [32.08675030811874, -23.816495757203423], [32.09071002204036, -23.816798905933425], [32.09254264100148, -23.81802071290211], [32.09528501042401, -23.816495739596647], [32.09803181757385, -23.816798930593336], [32.100163253767406, -23.81832397484379], [32.10351655561382, -23.81802075617526], [32.10351655561382, -23.817713074352916], [32.10504153729292, -23.818934823372594], [32.10748068325321, -23.81557717322871], [32.10839928137048, -23.813445695204443], [32.110838351616216, -23.811006541772727], [32.11419158255786, -23.808567475111577], [32.11754488280942, -23.807956539152336], [32.1208980790116, -23.806431566706156], [32.11815575219422, -23.804906525834998], [32.11388392717232, -23.803689161761326], [32.10839928137048, -23.80185649774461], [32.10504153729292, -23.800639125809447], [32.10199597277388, -23.79850322989475], [32.09955687653268, -23.796064112643847], [32.099860065574624, -23.792710903196767], [32.102910110493255, -23.789968504393414], [32.109919774214845, -23.788746704664703], [32.11540893599924, -23.787832590374087], [32.119984006692505, -23.78600438871668], [32.12211986306823, -23.783565270281237], [32.12608400177926, -23.7811217110465], [32.12882638725691, -23.77868250621562], [32.13675463312374, -23.768926073410903], [32.14041559313263, -23.760997733704883], [32.14498613846101, -23.753680399408328], [32.15230356322941, -23.745448878381595], [32.16145367318318, -23.735384652228603], [32.16938194386784, -23.726542253477223], [32.1776133800816, -23.71861397328285], [32.17822434207847, -23.711907506380392], [32.17456336841947, -23.70580744086443], [32.170599280598076, -23.70062600558978], [32.16145367318318, -23.701847743464615], [32.151389410455636, -23.703676013869348], [32.143461114244765, -23.705807475235602], [32.13584052176459, -23.710079282948943], [32.131568703067686, -23.713432498828766], [32.12333721384815, -23.718613983593], [32.11784810809243, -23.72593582660775], [32.109919774214845, -23.733556464736814], [32.103824240490894, -23.740262910957835], [32.09955687653268, -23.746059757307457], [32.096810021394035, -23.749109823736163], [32.08613943481719, -23.752155305323527], [32.083392586216135, -23.75276627075531], [32.08095350455595, -23.75642712901621], [32.07882203723637, -23.760997731089834], [32.0760752633676, -23.764961915451742], [32.07424696089793, -23.768011900923067], [32.07241880101874, -23.77167282643766], [32.073332841459695, -23.775026045985918], [32.069368764987416, -23.78112169478743], [32.065404630478405, -23.783868443942833], [32.05991544993202, -23.789357599878418], [32.0568654096223, -23.79484679764224], [32.055340444083285, -23.800331459874393]]]}, "properties": {"Name": "Mavodze_D", "area": 6732.58726551605, "mean": 7.550346357149882, "Project": "Limpopo NP Project"}}, {"id": "00000000000000000179", "type": "Feature", "geometry": {"type": "Polygon", "coordinates": [[[32.055340444083285, -23.800331459874393], [32.056562187098656, -23.805517399974644], [32.0568654096223, -23.80887065772401], [32.05869807999482, -23.811920655868335], [32.06479372369196, -23.812834779076972], [32.069061068987544, -23.81161745845849], [32.07241880101874, -23.81039568544611], [32.07698935970331, -23.81100655242554], [32.07790344833732, -23.813748880166205], [32.08278620179642, -23.81618802731346], [32.08675030811874, -23.816495757203423], [32.09071002204036, -23.816798905933425], [32.09254264100148, -23.81802071290211], [32.09528501042401, -23.816495739596647], [32.09803181757385, -23.816798930593336], [32.100163253767406, -23.81832397484379], [32.10351655561382, -23.81802075617526], [32.10351655561382, -23.817713074352916], [32.10504153729292, -23.818934823372594], [32.10748068325321, -23.81557717322871], [32.10839928137048, -23.813445695204443], [32.110838351616216, -23.811006541772727], [32.11419158255786, -23.808567475111577], [32.11754488280942, -23.807956539152336], [32.1208980790116, -23.806431566706156], [32.11815575219422, -23.804906525834998], [32.11388392717232, -23.803689161761326], [32.10839928137048, -23.80185649774461], [32.10504153729292, -23.800639125809447], [32.10199597277388, -23.79850322989475], [32.09955687653268, -23.796064112643847], [32.099860065574624, -23.792710903196767], [32.102910110493255, -23.789968504393414], [32.109919774214845, -23.788746704664703], [32.11540893599924, -23.787832590374087], [32.119984006692505, -23.78600438871668], [32.12211986306823, -23.783565270281237], [32.12608400177926, -23.7811217110465], [32.12882638725691, -23.77868250621562], [32.13675463312374, -23.768926073410903], [32.14041559313263, -23.760997733704883], [32.14498613846101, -23.753680399408328], [32.15230356322941, -23.745448878381595], [32.16145367318318, -23.735384652228603], [32.16938194386784, -23.726542253477223], [32.1776133800816, -23.71861397328285], [32.17822434207847, -23.711907506380392], [32.17456336841947, -23.70580744086443], [32.170599280598076, -23.70062600558978], [32.16145367318318, -23.701847743464615], [32.151389410455636, -23.703676013869348], [32.143461114244765, -23.705807475235602], [32.13584052176459, -23.710079282948943], [32.131568703067686, -23.713432498828766], [32.12333721384815, -23.718613983593], [32.11784810809243, -23.72593582660775], [32.109919774214845, -23.733556464736814], [32.103824240490894, -23.740262910957835], [32.09955687653268, -23.746059757307457], [32.096810021394035, -23.749109823736163], [32.08613943481719, -23.752155305323527], [32.083392586216135, -23.75276627075531], [32.08095350455595, -23.75642712901621], [32.07882203723637, -23.760997731089834], [32.0760752633676, -23.764961915451742], [32.07424696089793, -23.768011900923067], [32.07241880101874, -23.77167282643766], [32.073332841459695, -23.775026045985918], [32.069368764987416, -23.78112169478743], [32.065404630478405, -23.783868443942833], [32.05991544993202, -23.789357599878418], [32.0568654096223, -23.79484679764224], [32.055340444083285, -23.800331459874393]]]}, "properties": {"Name": "Mavodze 3", "area": 6732.58726551605, "mean": 7.550346357149882, "Project": "Limpopo NP Project"}}]}}, "temporal": {"results": [{"type": "FeatureCollection", "columns": {"EVI": "Float", "NDVI": "Float", "Name": "String", "date": "Long", "year": "Integer", "Bare ground": "Float", "system:index": "String"}, "features": [{"id": "2232", "type": "Feature", "geometry": None, "properties": {"EVI": 0.4748475557606069, "NDVI": 0.33402703432708375, "Name": "Limpopo National Park Central", "date": 1577836800000, "year": 2020, "Bare ground": 9.723272199631811}}, {"id": "2345", "type": "Feature", "geometry": None, "properties": {"EVI": 0.48462386088649106, "NDVI": 0.3397112823351862, "Name": "Mavodze 1", "date": 1577836800000, "year": 2020, "Bare ground": 12.283216706202111}}, {"id": "2347", "type": "Feature", "geometry": None, "properties": {"EVI": 0.539611482306072, "NDVI": 0.37605230361364905, "Name": "Mavodze 3", "date": 1577836800000, "year": 2020, "Bare ground": 10.077454067166885}}, {"id": "2349", "type": "Feature", "geometry": None, "properties": {"EVI": 0.4846238525704305, "NDVI": 0.33971127751789765, "Name": "Mavodze_A", "date": 1577836800000, "year": 2020, "Bare ground": 12.283215939790473}}, {"id": "2352", "type": "Feature", "geometry": None, "properties": {"EVI": 0.539611482306072, "NDVI": 0.37605230361364905, "Name": "Mavodze_D", "date": 1577836800000, "year": 2020, "Bare ground": 10.077454067166885}}], "statistics": {"2020": {"Mavodze 1": {"EVI": {"max": 0.6042319873088559, "min": 0.3023866710043296, "mean": 0.484623860886491}, "NDVI": {"max": 0.413103665805181, "min": 0.2225718458693911, "mean": 0.3397112823351862}, "Bare ground": {"max": 18.468478371771315, "min": 7.675941776433154, "mean": 12.28321670620211}}, "Mavodze 3": {"EVI": {"max": 0.6429354398079133, "min": 0.4079122162009896, "mean": 0.539611482306072}, "NDVI": {"max": 0.441686254177208, "min": 0.2953993968946004, "mean": 0.37605230361364905}, "Bare ground": {"max": 16.865420147470857, "min": 5.030007831013537, "mean": 10.077454067166885}}, "Mavodze_A": {"EVI": {"max": 0.6042319552584783, "min": 0.3023866688289584, "mean": 0.4846238525704305}, "NDVI": {"max": 0.41310364688540807, "min": 0.22257184522072085, "mean": 0.33971127751789765}, "Bare ground": {"max": 18.46847805860312, "min": 7.675940544280046, "mean": 12.283215939790473}}, "Mavodze_D": {"EVI": {"max": 0.6429354398079133, "min": 0.4079122162009896, "mean": 0.539611482306072}, "NDVI": {"max": 0.441686254177208, "min": 0.2953993968946004, "mean": 0.37605230361364905}, "Bare ground": {"max": 16.865420147470857, "min": 5.030007831013537, "mean": 10.077454067166885}}, "Limpopo National Park Central": {"EVI": {"max": 0.6423261767744879, "min": 0.2965242125476117, "mean": 0.4748475557606069}, "NDVI": {"max": 0.4352308211797352, "min": 0.21988657856929497, "mean": 0.33402703432708375}, "Bare ground": {"max": 13.106162170392476, "min": 5.897350814383153, "mean": 9.723272199631811}}}}}, {"id": "projects/ee-yekelaso1818/assets/Temporal_pre_export_20241202", "type": "FeatureCollection", "columns": {"date": "Long"}, "version": 1733164362540944, "features": [{"id": "00000000000000000960", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.8259463581665435, "NDVI": 0.5321435695251074, "Name": "Limpopo National Park Central", "date": 1485907200000, "year": 2017, "month": 1, "Bare ground": 6.181607809728489}}, {"id": "00000000000000000976", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.7951791281434595, "NDVI": 0.5150630237276925, "Name": "Mavodze 1", "date": 1485907200000, "year": 2017, "month": 1, "Bare ground": 8.629891601954712}}, {"id": "0000000000000000097d", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.7709572133000445, "NDVI": 0.5080929897203967, "Name": "Mavodze 3", "date": 1485907200000, "year": 2017, "month": 1, "Bare ground": 6.879310664611799}}, {"id": "00000000000000000975", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.7951791046100659, "NDVI": 0.5150630114747092, "Name": "Mavodze_A", "date": 1485907200000, "year": 2017, "month": 1, "Bare ground": 8.629890432382853}}, {"id": "0000000000000000097c", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.7709572133000445, "NDVI": 0.5080929897203967, "Name": "Mavodze_D", "date": 1485907200000, "year": 2017, "month": 1, "Bare ground": 6.879310664611799}}, {"id": "00000000000000000988", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.5470037100194012, "NDVI": 0.3853917839474786, "Name": "Limpopo National Park Central", "date": 1493596800000, "year": 2017, "month": 4, "Bare ground": 5.3263316802563345}}, {"id": "0000000000000000099e", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.6093373483365405, "NDVI": 0.4219203690139364, "Name": "Mavodze 1", "date": 1493596800000, "year": 2017, "month": 4, "Bare ground": 6.0321054287976645}}, {"id": "000000000000000009a5", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.728196425192352, "NDVI": 0.4897641524972487, "Name": "Mavodze 3", "date": 1493596800000, "year": 2017, "month": 4, "Bare ground": 4.459445475511216}}, {"id": "0000000000000000099d", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.6093373457179124, "NDVI": 0.4219203672154821, "Name": "Mavodze_A", "date": 1493596800000, "year": 2017, "month": 4, "Bare ground": 6.032104673156661}}, {"id": "000000000000000009a4", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.728196425192352, "NDVI": 0.4897641524972487, "Name": "Mavodze_D", "date": 1493596800000, "year": 2017, "month": 4, "Bare ground": 4.459445475511216}}, {"id": "000000000000000009b0", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.3015283476088467, "NDVI": 0.22338373898558683, "Name": "Limpopo National Park Central", "date": 1501545600000, "year": 2017, "month": 7, "Bare ground": 10.489362048455646}}, {"id": "000000000000000009c6", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.3323005080697059, "NDVI": 0.2428202667516286, "Name": "Mavodze 1", "date": 1501545600000, "year": 2017, "month": 7, "Bare ground": 11.531547596540396}}, {"id": "000000000000000009cd", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.4593771408072198, "NDVI": 0.32953014990618845, "Name": "Mavodze 3", "date": 1501545600000, "year": 2017, "month": 7, "Bare ground": 8.940566932727185}}, {"id": "000000000000000009c5", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.33230050066600986, "NDVI": 0.24282026158032216, "Name": "Mavodze_A", "date": 1501545600000, "year": 2017, "month": 7, "Bare ground": 11.531547123687698}}, {"id": "000000000000000009cc", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.4593771408072198, "NDVI": 0.32953014990618845, "Name": "Mavodze_D", "date": 1501545600000, "year": 2017, "month": 7, "Bare ground": 8.940566932727185}}, {"id": "000000000000000009d8", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.26344669167735896, "NDVI": 0.1968140307427279, "Name": "Limpopo National Park Central", "date": 1509494400000, "year": 2017, "month": 10, "Bare ground": 9.455775609561927}}, {"id": "000000000000000009ee", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.26946356078243244, "NDVI": 0.1991530251777957, "Name": "Mavodze 1", "date": 1509494400000, "year": 2017, "month": 10, "Bare ground": 11.965593780483172}}, {"id": "000000000000000009f5", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.30793697772321954, "NDVI": 0.22645569073114177, "Name": "Mavodze 3", "date": 1509494400000, "year": 2017, "month": 10, "Bare ground": 11.106746435947256}}, {"id": "000000000000000009ed", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.269463565900421, "NDVI": 0.19915302887016872, "Name": "Mavodze_A", "date": 1509494400000, "year": 2017, "month": 10, "Bare ground": 11.965591847556716}}, {"id": "000000000000000009f4", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.30793697772321954, "NDVI": 0.22645569073114177, "Name": "Mavodze_D", "date": 1509494400000, "year": 2017, "month": 10, "Bare ground": 11.106746435947256}}, {"id": "00000000000000000a00", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.547634710917738, "NDVI": 0.38133847693999784, "Name": "Limpopo National Park Central", "date": 1517443200000, "year": 2018, "month": 1, "Bare ground": 9.224079675020205}}, {"id": "00000000000000000a16", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.599976086465122, "NDVI": 0.4115678120943084, "Name": "Mavodze 1", "date": 1517443200000, "year": 2018, "month": 1, "Bare ground": 13.096757231720542}}, {"id": "00000000000000000a1d", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.6004660049051009, "NDVI": 0.41560053526852375, "Name": "Mavodze 3", "date": 1517443200000, "year": 2018, "month": 1, "Bare ground": 7.950247083853137}}, {"id": "00000000000000000a15", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.5999761091303, "NDVI": 0.4115678251893428, "Name": "Mavodze_A", "date": 1517443200000, "year": 2018, "month": 1, "Bare ground": 13.09675719204536}}, {"id": "00000000000000000a1c", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.6004660049051009, "NDVI": 0.41560053526852375, "Name": "Mavodze_D", "date": 1517443200000, "year": 2018, "month": 1, "Bare ground": 7.950247083853137}}, {"id": "00000000000000000a28", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.48295263931280297, "NDVI": 0.34852144901601456, "Name": "Limpopo National Park Central", "date": 1525132800000, "year": 2018, "month": 4, "Bare ground": 6.36817941309296}}, {"id": "00000000000000000a3e", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.5454328393423766, "NDVI": 0.3845531639517316, "Name": "Mavodze 1", "date": 1525132800000, "year": 2018, "month": 4, "Bare ground": 7.630962836969407}}, {"id": "00000000000000000a45", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.6198709846551407, "NDVI": 0.4317379238950295, "Name": "Mavodze 3", "date": 1525132800000, "year": 2018, "month": 4, "Bare ground": 4.920811354519987}}, {"id": "00000000000000000a3d", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.5454328597497452, "NDVI": 0.38455317701852904, "Name": "Mavodze_A", "date": 1525132800000, "year": 2018, "month": 4, "Bare ground": 7.630961535885337}}, {"id": "00000000000000000a44", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.6198709846551407, "NDVI": 0.4317379238950295, "Name": "Mavodze_D", "date": 1525132800000, "year": 2018, "month": 4, "Bare ground": 4.920811354519987}}, {"id": "00000000000000000a50", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.23950231999740249, "NDVI": 0.18188081733501624, "Name": "Limpopo National Park Central", "date": 1533081600000, "year": 2018, "month": 7, "Bare ground": 10.39943707303038}}, {"id": "00000000000000000a66", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.2724489811060329, "NDVI": 0.2035801519010715, "Name": "Mavodze 1", "date": 1533081600000, "year": 2018, "month": 7, "Bare ground": 8.544586370506785}}, {"id": "00000000000000000a6d", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.3425991812442114, "NDVI": 0.2556426962059192, "Name": "Mavodze 3", "date": 1533081600000, "year": 2018, "month": 7, "Bare ground": 10.605867517475966}}, {"id": "00000000000000000a65", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.2724489838799461, "NDVI": 0.20358015337050975, "Name": "Mavodze_A", "date": 1533081600000, "year": 2018, "month": 7, "Bare ground": 8.544586641045703}}, {"id": "00000000000000000a6c", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.3425991812442114, "NDVI": 0.2556426962059192, "Name": "Mavodze_D", "date": 1533081600000, "year": 2018, "month": 7, "Bare ground": 10.605867517475966}}, {"id": "00000000000000000a78", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.24184970004779285, "NDVI": 0.18014216817226503, "Name": "Limpopo National Park Central", "date": 1541030400000, "year": 2018, "month": 10, "Bare ground": 12.212703622506137}}, {"id": "00000000000000000a8e", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.2653248616192429, "NDVI": 0.19504790500104435, "Name": "Mavodze 1", "date": 1541030400000, "year": 2018, "month": 10, "Bare ground": 20.11376768852291}}, {"id": "00000000000000000a95", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.3023653289168797, "NDVI": 0.2217112835253615, "Name": "Mavodze 3", "date": 1541030400000, "year": 2018, "month": 10, "Bare ground": 14.901093257656608}}, {"id": "00000000000000000a8d", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.2653248584600857, "NDVI": 0.195047903746972, "Name": "Mavodze_A", "date": 1541030400000, "year": 2018, "month": 10, "Bare ground": 20.113766212418824}}, {"id": "00000000000000000a94", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.3023653289168797, "NDVI": 0.2217112835253615, "Name": "Mavodze_D", "date": 1541030400000, "year": 2018, "month": 10, "Bare ground": 14.901093257656608}}, {"id": "00000000000000000aa0", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.6169765336794916, "NDVI": 0.4195722284308421, "Name": "Limpopo National Park Central", "date": 1548979200000, "year": 2019, "month": 1, "Bare ground": 10.240456980660982}}, {"id": "00000000000000000ab6", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.645689108892072, "NDVI": 0.4353147819144145, "Name": "Mavodze 1", "date": 1548979200000, "year": 2019, "month": 1, "Bare ground": 10.403588868575412}}, {"id": "00000000000000000abd", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.7166775897540884, "NDVI": 0.4770062122781433, "Name": "Mavodze 3", "date": 1548979200000, "year": 2019, "month": 1, "Bare ground": 7.666736803250153}}, {"id": "00000000000000000ab5", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.6456890891519944, "NDVI": 0.43531477225375015, "Name": "Mavodze_A", "date": 1548979200000, "year": 2019, "month": 1, "Bare ground": 10.403588752936606}}, {"id": "00000000000000000abc", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.7166775897540884, "NDVI": 0.4770062122781433, "Name": "Mavodze_D", "date": 1548979200000, "year": 2019, "month": 1, "Bare ground": 7.666736803250153}}, {"id": "00000000000000000ac8", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.4596854254257808, "NDVI": 0.32884583642118204, "Name": "Limpopo National Park Central", "date": 1556668800000, "year": 2019, "month": 4, "Bare ground": 7.875020228171779}}, {"id": "00000000000000000ade", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.5589678666411972, "NDVI": 0.38798524475815527, "Name": "Mavodze 1", "date": 1556668800000, "year": 2019, "month": 4, "Bare ground": 8.037839496632218}}, {"id": "00000000000000000ae5", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.6247912372473132, "NDVI": 0.4312783823251507, "Name": "Mavodze 3", "date": 1556668800000, "year": 2019, "month": 4, "Bare ground": 4.908736750036085}}, {"id": "00000000000000000add", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.5589678479305887, "NDVI": 0.38798523640063143, "Name": "Mavodze_A", "date": 1556668800000, "year": 2019, "month": 4, "Bare ground": 8.037838298403841}}, {"id": "00000000000000000ae4", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.6247912372473132, "NDVI": 0.4312783823251507, "Name": "Mavodze_D", "date": 1556668800000, "year": 2019, "month": 4, "Bare ground": 4.908736750036085}}, {"id": "00000000000000000af0", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.2715490438216425, "NDVI": 0.2019167386994745, "Name": "Limpopo National Park Central", "date": 1564617600000, "year": 2019, "month": 7, "Bare ground": 10.228592032241073}}, {"id": "00000000000000000b06", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.3057912300068835, "NDVI": 0.22427816804357772, "Name": "Mavodze 1", "date": 1564617600000, "year": 2019, "month": 7, "Bare ground": 11.509204992201862}}, {"id": "00000000000000000b0d", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.37435035608624206, "NDVI": 0.27224750301096645, "Name": "Mavodze 3", "date": 1564617600000, "year": 2019, "month": 7, "Bare ground": 11.29056580487099}}, {"id": "00000000000000000b05", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.30579122322087204, "NDVI": 0.22427816280333088, "Name": "Mavodze_A", "date": 1564617600000, "year": 2019, "month": 7, "Bare ground": 11.509204682194165}}, {"id": "00000000000000000b0c", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.37435035608624206, "NDVI": 0.27224750301096645, "Name": "Mavodze_D", "date": 1564617600000, "year": 2019, "month": 7, "Bare ground": 11.29056580487099}}, {"id": "00000000000000000b18", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.2827590836324765, "NDVI": 0.20729087592805664, "Name": "Limpopo National Park Central", "date": 1572566400000, "year": 2019, "month": 10, "Bare ground": 13.535640209930127}}, {"id": "00000000000000000b2e", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.32917077153159585, "NDVI": 0.23859302735593815, "Name": "Mavodze 1", "date": 1572566400000, "year": 2019, "month": 10, "Bare ground": 16.33304268411409}}, {"id": "00000000000000000b35", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.39555773163128555, "NDVI": 0.28271770308548905, "Name": "Mavodze 3", "date": 1572566400000, "year": 2019, "month": 10, "Bare ground": 17.23904205237236}}, {"id": "00000000000000000b2d", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.32917075016756037, "NDVI": 0.23859301344220515, "Name": "Mavodze_A", "date": 1572566400000, "year": 2019, "month": 10, "Bare ground": 16.333039509601083}}, {"id": "00000000000000000b34", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.39555773163128555, "NDVI": 0.28271770308548905, "Name": "Mavodze_D", "date": 1572566400000, "year": 2019, "month": 10, "Bare ground": 17.23904205237236}}, {"id": "00000000000000000b40", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.6423261767744879, "NDVI": 0.4352308211797352, "Name": "Limpopo National Park Central", "date": 1580515200000, "year": 2020, "month": 1, "Bare ground": 8.98706113459109}}, {"id": "00000000000000000b56", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.6042319873088559, "NDVI": 0.413103665805181, "Name": "Mavodze 1", "date": 1580515200000, "year": 2020, "month": 1, "Bare ground": 12.11762368828357}}, {"id": "00000000000000000b5d", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.6429354398079133, "NDVI": 0.4380004269568928, "Name": "Mavodze 3", "date": 1580515200000, "year": 2020, "month": 1, "Bare ground": 8.34739471218475}}, {"id": "00000000000000000b55", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.6042319552584783, "NDVI": 0.41310364688540807, "Name": "Mavodze_A", "date": 1580515200000, "year": 2020, "month": 1, "Bare ground": 12.117621646822377}}, {"id": "00000000000000000b5c", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.6429354398079133, "NDVI": 0.4380004269568928, "Name": "Mavodze_D", "date": 1580515200000, "year": 2020, "month": 1, "Bare ground": 8.34739471218475}}, {"id": "00000000000000000b68", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.5351194158986845, "NDVI": 0.3773347281100046, "Name": "Limpopo National Park Central", "date": 1588291200000, "year": 2020, "month": 4, "Bare ground": 5.897350814383153}}, {"id": "00000000000000000b7e", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.5484059012916043, "NDVI": 0.3842373458347039, "Name": "Mavodze 1", "date": 1588291200000, "year": 2020, "month": 4, "Bare ground": 7.675941776433154}}, {"id": "00000000000000000b85", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.6405395453746783, "NDVI": 0.441686254177208, "Name": "Mavodze 3", "date": 1588291200000, "year": 2020, "month": 4, "Bare ground": 5.030007831013537}}, {"id": "00000000000000000b7d", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.5484059108525966, "NDVI": 0.3842373517650412, "Name": "Mavodze_A", "date": 1588291200000, "year": 2020, "month": 4, "Bare ground": 7.675940544280046}}, {"id": "00000000000000000b84", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.6405395453746783, "NDVI": 0.441686254177208, "Name": "Mavodze_D", "date": 1588291200000, "year": 2020, "month": 4, "Bare ground": 5.030007831013537}}, {"id": "00000000000000000b90", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.2965242125476117, "NDVI": 0.21988657856929497, "Name": "Limpopo National Park Central", "date": 1596240000000, "year": 2020, "month": 7, "Bare ground": 10.902514679160523}}, {"id": "00000000000000000ba6", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.3023866710043296, "NDVI": 0.2225718458693911, "Name": "Mavodze 1", "date": 1596240000000, "year": 2020, "month": 7, "Bare ground": 10.8708229883204}}, {"id": "00000000000000000bad", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.4079122162009896, "NDVI": 0.2953993968946004, "Name": "Mavodze 3", "date": 1596240000000, "year": 2020, "month": 7, "Bare ground": 10.066993577998396}}, {"id": "00000000000000000ba5", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.3023866688289584, "NDVI": 0.22257184522072085, "Name": "Mavodze_A", "date": 1596240000000, "year": 2020, "month": 7, "Bare ground": 10.870823509456349}}, {"id": "00000000000000000bac", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.4079122162009896, "NDVI": 0.2953993968946004, "Name": "Mavodze_D", "date": 1596240000000, "year": 2020, "month": 7, "Bare ground": 10.066993577998396}}, {"id": "00000000000000000bb8", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.42542041782164336, "NDVI": 0.30365600944930016, "Name": "Limpopo National Park Central", "date": 1604188800000, "year": 2020, "month": 10, "Bare ground": 13.106162170392476}}, {"id": "00000000000000000bce", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.4834708839411744, "NDVI": 0.33893227183146896, "Name": "Mavodze 1", "date": 1604188800000, "year": 2020, "month": 10, "Bare ground": 18.468478371771315}}, {"id": "00000000000000000bd5", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.46705872784070707, "NDVI": 0.329123136425895, "Name": "Mavodze 3", "date": 1604188800000, "year": 2020, "month": 10, "Bare ground": 16.865420147470857}}, {"id": "00000000000000000bcd", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.4834708753416887, "NDVI": 0.3389322662004205, "Name": "Mavodze_A", "date": 1604188800000, "year": 2020, "month": 10, "Bare ground": 18.46847805860312}}, {"id": "00000000000000000bd4", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.46705872784070707, "NDVI": 0.329123136425895, "Name": "Mavodze_D", "date": 1604188800000, "year": 2020, "month": 10, "Bare ground": 16.865420147470857}}, {"id": "00000000000000000be0", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.8947685554295333, "NDVI": 0.5700359941975318, "Name": "Limpopo National Park Central", "date": 1612137600000, "year": 2021, "month": 1, "Bare ground": 4.258803081467935}}, {"id": "00000000000000000bf6", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.9749980603626583, "NDVI": 0.6073948392869133, "Name": "Mavodze 1", "date": 1612137600000, "year": 2021, "month": 1, "Bare ground": 4.035818395382849}}, {"id": "00000000000000000bfd", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.9444966003566206, "NDVI": 0.5946758307006252, "Name": "Mavodze 3", "date": 1612137600000, "year": 2021, "month": 1, "Bare ground": 3.924743329450321}}, {"id": "00000000000000000bf5", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.974998046138512, "NDVI": 0.6073948338444243, "Name": "Mavodze_A", "date": 1612137600000, "year": 2021, "month": 1, "Bare ground": 4.0358181585057515}}, {"id": "00000000000000000bfc", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.9444966003566206, "NDVI": 0.5946758307006252, "Name": "Mavodze_D", "date": 1612137600000, "year": 2021, "month": 1, "Bare ground": 3.924743329450321}}, {"id": "00000000000000000c08", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.6960831372862759, "NDVI": 0.47434194867687574, "Name": "Limpopo National Park Central", "date": 1619827200000, "year": 2021, "month": 4, "Bare ground": 3.841451152280773}}, {"id": "00000000000000000c1e", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.7708785379874161, "NDVI": 0.5132535561617857, "Name": "Mavodze 1", "date": 1619827200000, "year": 2021, "month": 4, "Bare ground": 3.6127687297552415}}, {"id": "00000000000000000c25", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.7788741630295263, "NDVI": 0.5201705325675473, "Name": "Mavodze 3", "date": 1619827200000, "year": 2021, "month": 4, "Bare ground": 4.235058239764198}}, {"id": "00000000000000000c1d", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.7708785326510934, "NDVI": 0.5132535542192088, "Name": "Mavodze_A", "date": 1619827200000, "year": 2021, "month": 4, "Bare ground": 3.6127685711465376}}, {"id": "00000000000000000c24", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.7788741630295263, "NDVI": 0.5201705325675473, "Name": "Mavodze_D", "date": 1619827200000, "year": 2021, "month": 4, "Bare ground": 4.235058239764198}}, {"id": "00000000000000000c30", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.3969882713648644, "NDVI": 0.2908416470072133, "Name": "Limpopo National Park Central", "date": 1627776000000, "year": 2021, "month": 7, "Bare ground": 9.088986472041038}}, {"id": "00000000000000000c46", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.4078441208185365, "NDVI": 0.2974426429137204, "Name": "Mavodze 1", "date": 1627776000000, "year": 2021, "month": 7, "Bare ground": 10.170086050548454}}, {"id": "00000000000000000c4d", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.509553217311747, "NDVI": 0.3648011528195411, "Name": "Mavodze 3", "date": 1627776000000, "year": 2021, "month": 7, "Bare ground": 6.497981717265076}}, {"id": "00000000000000000c45", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.40784409797423526, "NDVI": 0.29744262739440197, "Name": "Mavodze_A", "date": 1627776000000, "year": 2021, "month": 7, "Bare ground": 10.170086765922434}}, {"id": "00000000000000000c4c", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.509553217311747, "NDVI": 0.3648011528195411, "Name": "Mavodze_D", "date": 1627776000000, "year": 2021, "month": 7, "Bare ground": 6.497981717265076}}, {"id": "00000000000000000c58", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.3170163155904578, "NDVI": 0.23494655984121168, "Name": "Limpopo National Park Central", "date": 1635724800000, "year": 2021, "month": 10, "Bare ground": 9.566699989595}}, {"id": "00000000000000000c6e", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.3259180586473718, "NDVI": 0.24093830874190336, "Name": "Mavodze 1", "date": 1635724800000, "year": 2021, "month": 10, "Bare ground": 9.397691427866464}}, {"id": "00000000000000000c75", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.3270166635614783, "NDVI": 0.24189563665868383, "Name": "Mavodze 3", "date": 1635724800000, "year": 2021, "month": 10, "Bare ground": 10.648955042734991}}, {"id": "00000000000000000c6d", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.32591804464679786, "NDVI": 0.2409382994263679, "Name": "Mavodze_A", "date": 1635724800000, "year": 2021, "month": 10, "Bare ground": 9.397689976980724}}, {"id": "00000000000000000c74", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.3270166635614783, "NDVI": 0.24189563665868383, "Name": "Mavodze_D", "date": 1635724800000, "year": 2021, "month": 10, "Bare ground": 10.648955042734991}}, {"id": "00000000000000000c80", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.39341122500767495, "NDVI": 0.26729830572023516, "Name": "Limpopo National Park Central", "date": 1643673600000, "year": 2022, "month": 1, "Bare ground": 54.681300873076545}}, {"id": "00000000000000000c96", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.3912882962565464, "NDVI": 0.2679668105972586, "Name": "Mavodze 1", "date": 1643673600000, "year": 2022, "month": 1, "Bare ground": 54.65338892315694}}, {"id": "00000000000000000c9d", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.3591897378972765, "NDVI": 0.24784985848910257, "Name": "Mavodze 3", "date": 1643673600000, "year": 2022, "month": 1, "Bare ground": 56.12048195753456}}, {"id": "00000000000000000c95", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.3912882999347268, "NDVI": 0.2679668115556656, "Name": "Mavodze_A", "date": 1643673600000, "year": 2022, "month": 1, "Bare ground": 54.65338876149072}}, {"id": "00000000000000000c9c", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.3591897378972765, "NDVI": 0.24784985848910257, "Name": "Mavodze_D", "date": 1643673600000, "year": 2022, "month": 1, "Bare ground": 56.12048195753456}}, {"id": "00000000000000000ca8", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.36131848106429953, "NDVI": 0.2503503016126336, "Name": "Limpopo National Park Central", "date": 1651363200000, "year": 2022, "month": 4, "Bare ground": 53.93683855256363}}, {"id": "00000000000000000cbe", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.3743537083245479, "NDVI": 0.2586871318921063, "Name": "Mavodze 1", "date": 1651363200000, "year": 2022, "month": 4, "Bare ground": 53.46243809860939}}, {"id": "00000000000000000cc5", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.3750128968847844, "NDVI": 0.25901404908554077, "Name": "Mavodze 3", "date": 1651363200000, "year": 2022, "month": 4, "Bare ground": 51.84943967204177}}, {"id": "00000000000000000cbd", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.3743537179419916, "NDVI": 0.2586871379947209, "Name": "Mavodze_A", "date": 1651363200000, "year": 2022, "month": 4, "Bare ground": 53.46243804897886}}, {"id": "00000000000000000cc4", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.3750128968847844, "NDVI": 0.25901404908554077, "Name": "Mavodze_D", "date": 1651363200000, "year": 2022, "month": 4, "Bare ground": 51.84943967204177}}, {"id": "00000000000000000cd0", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.20972144854501767, "NDVI": 0.15062666016787643, "Name": "Limpopo National Park Central", "date": 1659312000000, "year": 2022, "month": 7, "Bare ground": 70.75382455848836}}, {"id": "00000000000000000ce6", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.2147095962338984, "NDVI": 0.15415291028085715, "Name": "Mavodze 1", "date": 1659312000000, "year": 2022, "month": 7, "Bare ground": 71.9003276859142}}, {"id": "00000000000000000ced", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.2611291149670453, "NDVI": 0.18533849001059083, "Name": "Mavodze 3", "date": 1659312000000, "year": 2022, "month": 7, "Bare ground": 67.61720514361727}}, {"id": "00000000000000000ce5", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.21470960784350723, "NDVI": 0.15415291819305096, "Name": "Mavodze_A", "date": 1659312000000, "year": 2022, "month": 7, "Bare ground": 71.90032775837372}}, {"id": "00000000000000000cec", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.2611291149670453, "NDVI": 0.18533849001059083, "Name": "Mavodze_D", "date": 1659312000000, "year": 2022, "month": 7, "Bare ground": 67.61720514361727}}, {"id": "00000000000000000cf8", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.26855224535438543, "NDVI": 0.18751604582511944, "Name": "Limpopo National Park Central", "date": 1667260800000, "year": 2022, "month": 10, "Bare ground": 69.79839711392698}}, {"id": "00000000000000000d0e", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.23584257890407168, "NDVI": 0.16645607524645958, "Name": "Mavodze 1", "date": 1667260800000, "year": 2022, "month": 10, "Bare ground": 75.0230456161956}}, {"id": "00000000000000000d15", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.2771593114658392, "NDVI": 0.1936421594622899, "Name": "Mavodze 3", "date": 1667260800000, "year": 2022, "month": 10, "Bare ground": 69.90304371766847}}, {"id": "00000000000000000d0d", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.23584257733060937, "NDVI": 0.16645607431460985, "Name": "Mavodze_A", "date": 1667260800000, "year": 2022, "month": 10, "Bare ground": 75.02304597305562}}, {"id": "00000000000000000d14", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.2771593114658392, "NDVI": 0.1936421594622899, "Name": "Mavodze_D", "date": 1667260800000, "year": 2022, "month": 10, "Bare ground": 69.90304371766847}}, {"id": "00000000000000000d20", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.43774050734657416, "NDVI": 0.29345831727126753, "Name": "Limpopo National Park Central", "date": 1675209600000, "year": 2023, "month": 1, "Bare ground": 51.469789298203146}}, {"id": "00000000000000000d36", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.4827924410856503, "NDVI": 0.3201467942060272, "Name": "Mavodze 1", "date": 1675209600000, "year": 2023, "month": 1, "Bare ground": 50.01921952566142}}, {"id": "00000000000000000d3d", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.4778956707154551, "NDVI": 0.31745689258800786, "Name": "Mavodze 3", "date": 1675209600000, "year": 2023, "month": 1, "Bare ground": 49.82871115534136}}, {"id": "00000000000000000d35", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.48279244789515335, "NDVI": 0.32014679880510793, "Name": "Mavodze_A", "date": 1675209600000, "year": 2023, "month": 1, "Bare ground": 50.019218686339336}}, {"id": "00000000000000000d3c", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.4778956707154551, "NDVI": 0.31745689258800786, "Name": "Mavodze_D", "date": 1675209600000, "year": 2023, "month": 1, "Bare ground": 49.82871115534136}}, {"id": "00000000000000000d48", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.36862722424484545, "NDVI": 0.2535804658442324, "Name": "Limpopo National Park Central", "date": 1682899200000, "year": 2023, "month": 4, "Bare ground": 54.135890583319906}}, {"id": "00000000000000000d5e", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.4360222011802103, "NDVI": 0.2947865857521995, "Name": "Mavodze 1", "date": 1682899200000, "year": 2023, "month": 4, "Bare ground": 50.16996152387218}}, {"id": "00000000000000000d65", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.44334990420553794, "NDVI": 0.299152539003218, "Name": "Mavodze 3", "date": 1682899200000, "year": 2023, "month": 4, "Bare ground": 48.51084340994207}}, {"id": "00000000000000000d5d", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.43602219687239346, "NDVI": 0.2947865833559813, "Name": "Mavodze_A", "date": 1682899200000, "year": 2023, "month": 4, "Bare ground": 50.16996241867348}}, {"id": "00000000000000000d64", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.44334990420553794, "NDVI": 0.299152539003218, "Name": "Mavodze_D", "date": 1682899200000, "year": 2023, "month": 4, "Bare ground": 48.51084340994207}}, {"id": "00000000000000000d70", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.1746502194725212, "NDVI": 0.12640761221273775, "Name": "Limpopo National Park Central", "date": 1690848000000, "year": 2023, "month": 7, "Bare ground": 71.48544189192393}}, {"id": "00000000000000000d86", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.1965908676697664, "NDVI": 0.1415447339288866, "Name": "Mavodze 1", "date": 1690848000000, "year": 2023, "month": 7, "Bare ground": 71.4051855124845}}, {"id": "00000000000000000d8d", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.2615517353359535, "NDVI": 0.18481028771734304, "Name": "Mavodze 3", "date": 1690848000000, "year": 2023, "month": 7, "Bare ground": 66.09710370182603}}, {"id": "00000000000000000d85", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.19659085853021252, "NDVI": 0.14154472789533587, "Name": "Mavodze_A", "date": 1690848000000, "year": 2023, "month": 7, "Bare ground": 71.40518525793684}}, {"id": "00000000000000000d8c", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.2615517353359535, "NDVI": 0.18481028771734304, "Name": "Mavodze_D", "date": 1690848000000, "year": 2023, "month": 7, "Bare ground": 66.09710370182603}}, {"id": "00000000000000000d98", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.23423455690455527, "NDVI": 0.165839051651565, "Name": "Limpopo National Park Central", "date": 1698796800000, "year": 2023, "month": 10, "Bare ground": 74.43415108603746}}, {"id": "00000000000000000dae", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.27469422496906476, "NDVI": 0.19290626795525367, "Name": "Mavodze 1", "date": 1698796800000, "year": 2023, "month": 10, "Bare ground": 72.56034393889801}}, {"id": "00000000000000000db5", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.2737727420841158, "NDVI": 0.19155404074810073, "Name": "Mavodze 3", "date": 1698796800000, "year": 2023, "month": 10, "Bare ground": 71.84343397144315}}, {"id": "00000000000000000dad", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.2746942202404836, "NDVI": 0.19290626514113335, "Name": "Mavodze_A", "date": 1698796800000, "year": 2023, "month": 10, "Bare ground": 72.56034479747211}}, {"id": "00000000000000000db4", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.2737727420841158, "NDVI": 0.19155404074810073, "Name": "Mavodze_D", "date": 1698796800000, "year": 2023, "month": 10, "Bare ground": 71.84343397144315}}, {"id": "00000000000000000dc0", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.3915070694797783, "NDVI": 0.2662614807362243, "Name": "Limpopo National Park Central", "date": 1706745600000, "year": 2024, "month": 1, "Bare ground": 54.60303153049906}}, {"id": "00000000000000000dd6", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.4053449832220785, "NDVI": 0.27537103347003256, "Name": "Mavodze 1", "date": 1706745600000, "year": 2024, "month": 1, "Bare ground": 53.91210819324055}}, {"id": "00000000000000000ddd", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.38127546388885225, "NDVI": 0.26013515358938494, "Name": "Mavodze 3", "date": 1706745600000, "year": 2024, "month": 1, "Bare ground": 55.45831979409589}}, {"id": "00000000000000000dd5", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.4053449694060369, "NDVI": 0.27537102534400776, "Name": "Mavodze_A", "date": 1706745600000, "year": 2024, "month": 1, "Bare ground": 53.912108513223686}}, {"id": "00000000000000000ddc", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.38127546388885225, "NDVI": 0.26013515358938494, "Name": "Mavodze_D", "date": 1706745600000, "year": 2024, "month": 1, "Bare ground": 55.45831979409589}}, {"id": "00000000000000000de8", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.2582742190862988, "NDVI": 0.1831158892081924, "Name": "Limpopo National Park Central", "date": 1714521600000, "year": 2024, "month": 4, "Bare ground": 66.0432091052189}}, {"id": "00000000000000000dfe", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.2921344701297763, "NDVI": 0.2053346225700617, "Name": "Mavodze 1", "date": 1714521600000, "year": 2024, "month": 4, "Bare ground": 63.41928506377413}}, {"id": "00000000000000000e05", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.3312038880196004, "NDVI": 0.2308331851801276, "Name": "Mavodze 3", "date": 1714521600000, "year": 2024, "month": 4, "Bare ground": 57.455685326666845}}, {"id": "00000000000000000dfd", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.29213444558117835, "NDVI": 0.2053346064924115, "Name": "Mavodze_A", "date": 1714521600000, "year": 2024, "month": 4, "Bare ground": 63.41928728846617}}, {"id": "00000000000000000e04", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.3312038880196004, "NDVI": 0.2308331851801276, "Name": "Mavodze_D", "date": 1714521600000, "year": 2024, "month": 4, "Bare ground": 57.455685326666845}}, {"id": "00000000000000000e10", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.15795700012313893, "NDVI": 0.1147347219910602, "Name": "Limpopo National Park Central", "date": 1722470400000, "year": 2024, "month": 7, "Bare ground": 73.21244482748418}}, {"id": "00000000000000000e26", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.168630489350831, "NDVI": 0.12235040545734956, "Name": "Mavodze 1", "date": 1722470400000, "year": 2024, "month": 7, "Bare ground": 73.09173015531364}}, {"id": "00000000000000000e2d", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.20406651600747197, "NDVI": 0.14642783988069108, "Name": "Mavodze 3", "date": 1722470400000, "year": 2024, "month": 7, "Bare ground": 71.59627511573994}}, {"id": "00000000000000000e25", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.16863047972564812, "NDVI": 0.12235039913221513, "Name": "Mavodze_A", "date": 1722470400000, "year": 2024, "month": 7, "Bare ground": 73.09173046423045}}, {"id": "00000000000000000e2c", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.20406651600747197, "NDVI": 0.14642783988069108, "Name": "Mavodze_D", "date": 1722470400000, "year": 2024, "month": 7, "Bare ground": 71.59627511573994}}, {"id": "00000000000000000e38", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.14779732874681137, "NDVI": 0.10695346709047236, "Name": "Limpopo National Park Central", "date": 1730419200000, "year": 2024, "month": 10, "Bare ground": 77.0897749679337}}, {"id": "00000000000000000e4e", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.1684917341940937, "NDVI": 0.12146343290299257, "Name": "Mavodze 1", "date": 1730419200000, "year": 2024, "month": 10, "Bare ground": 77.58844779496789}}, {"id": "00000000000000000e55", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.18866391477929076, "NDVI": 0.1350647179224072, "Name": "Mavodze 3", "date": 1730419200000, "year": 2024, "month": 10, "Bare ground": 77.96780136712347}}, {"id": "00000000000000000e4d", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.16849173204786977, "NDVI": 0.12146343159644728, "Name": "Mavodze_A", "date": 1730419200000, "year": 2024, "month": 10, "Bare ground": 77.5884473529975}}, {"id": "00000000000000000e54", "type": "Feature", "geometry": {"type": "MultiPoint", "coordinates": []}, "properties": {"EVI": 0.18866391477929076, "NDVI": 0.1350647179224072, "Name": "Mavodze_D", "date": 1730419200000, "year": 2024, "month": 10, "Bare ground": 77.96780136712347}}], "properties": {"system:asset_size": 705844}}]}}
            return Response(
                AnalysisResultSerializer({
                    'data': data,
                    'results': results,
                    'task_id': None,
                    'status': TaskStatus.COMPLETED,
                    'is_cached': True,
                    'error': None,
                    'started_at': None,
                    'completed_at': None
                }).data
            )
            if results is not None:
                return Response(
                    AnalysisResultSerializer({
                        'data': data,
                        'results': results,
                        'task_id': None,
                        'status': TaskStatus.COMPLETED,
                        'is_cached': True,
                        'error': None,
                        'started_at': None,
                        'completed_at': None
                    }).data
                )

            # validate spatial analysis
            if data['analysisType'] == 'Spatial':
                self.validate_spatial_analysis(data)

            # Create task object
            analysis_task = AnalysisTask.objects.create(
                analysis_inputs=data,
                submitted_by=request.user
            )

            # submit task
            task = run_analysis_task.delay(analysis_task.id)
            analysis_task.task_id = task.id
            analysis_task.save(update_fields=['task_id'])

            return Response(AnalysisResultSerializer({
                'data': data,
                'results': None,
                'task_id': analysis_task.id,
                'status': TaskStatus.PENDING,
                'is_cached': False,
                'error': None,
                'started_at': analysis_task.created_at,
                'completed_at': None
            }).data)
        except ValueError as e:
            logging.error(f"Validation error: {e}")
            return Response(
                {
                    'error': str(e),
                    'status': TaskStatus.FAILED
                },
                status=status.HTTP_400_BAD_REQUEST
            )
        except Exception:
            logging.error("An error occurred during analysis", exc_info=True)
            return Response(
                {
                    'error': (
                        "An internal error has occurred. Please try again."
                    ),
                    'status': TaskStatus.FAILED
                },
                status=status.HTTP_400_BAD_REQUEST
            )


class FetchAnalysisTaskAPI(APIView):
    """API to fetch analysis task status and results."""

    def get(self, request, *args, **kwargs):
        """Fetch analysis task status and results."""
        task_id = kwargs.get('task_id')
        try:
            analysis_task = AnalysisTask.objects.get(id=task_id)
            if analysis_task.status == TaskStatus.COMPLETED:
                results = analysis_task.result
            else:
                results = None

            return Response(AnalysisResultSerializer({
                'data': analysis_task.analysis_inputs,
                'results': results,
                'task_id': task_id,
                'status': analysis_task.status,
                'is_cached': False,
                'error': (
                    analysis_task.error.get('message') if
                    analysis_task.error else None
                ),
                'started_at': analysis_task.created_at,
                'completed_at': analysis_task.completed_at
            }).data)
        except AnalysisTask.DoesNotExist:
            return Response(
                {'error': 'Task not found'}, status=status.HTTP_404_NOT_FOUND
            )
